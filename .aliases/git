#dotfiles git (rather than dfr (dotfiles repo) which is too close to drf (docker run fast.)) also deathfire grasp.

alias dfg='git --git-dir=$HOME/.dotfiles-repo/ --work-tree=$HOME'


function fix_symlink_for_dotfiles() {
	#Check input file is a symlink
	if [ -L "$1" ]; then
		symlink=$1
		target=`readlink "$symlink"`
		#if the symlink goes inside the home directory; make it relative.
		if [[ $target == /home/* ]]; then
			ln -srf $target $symlink
		elif [[ $target == /* ]]; then
			echo "Found non-relative symlink in dotfiles:"
			ls -l $symlink
		fi
	fi
}

function fix_symlinks_for_dotfiles() {
	dfg ls-tree -r --name-only --full-tree HEAD | while read line; do fix_symlink_for_dotfiles $line; done
}


alias dfgk='add_ssh_key github_fcdcbda'

alias dfgs='dfg status'

alias dfgd='dfg diff'
alias dfgdc='dfgd --cached'

#provide the branch to pull changes from as an arg
alias dfgm='dfg difftool -d -t meld'
alias dfgmp='dfgm archpatricol'
alias dfgmw='dfgm archwork'
alias dfgmda='dfgm dockerarch'
alias dfgmdu='dfgm dockerubuntu'

alias dfga='dfg add'
alias dfgaa='dfga -u && dfga ~/.themes ~/.aliases ~/.config/wpg ~/.config/powerline ~/.config/wallpapers ~/.config/qt5ct/'
alias dfgc='dfg commit -v'
alias dfgac='dfgaa && dfgc'
alias dfgacm='(dfgac -m "merge from all others" -e || true)'

alias dfgch='dfg checkout'
alias dfgchp='dfgch archpatricol'
alias dfgchw='dfgch archwork'
alias dfgchda='dfgch dockerarch'
alias dfgchdu='dfgch dockerubuntu'

alias dfgpop='dfg stash pop'
alias dfgpopall='while dfgpop; do :; done'

alias dfgp='dfg push'

alias dfgfullmerge='dfgchp && dfgmw && dfg stash && dfgchda && dfgmdu && dfg stash && dfgchp && dfgpopall && dfgmda && dfgacm && dfgchw && dfgmp && dfgacm && dfgchda && dfgpopall && dfgmp && dfgacm && dfgchdu && dfgmda && dfgacm'
alias dfgmergeall='dfgfullmerge'

alias dfgpopush='dfgpopall && dfgs && dfgp'
alias dfgpushall='dfgchdu && dfgpopush && dfgchda && dfgpopush && dfgchw && dfgpopush && dfgchp && dfgpopush'

alias sysg='sudo git --git-dir=/root/systemfiles-repo/ --work-tree=/'

alias gputemp='nvidia-smi --query-gpu=temperature.gpu --format=csv,noheader,nounits'

